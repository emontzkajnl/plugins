const advancedAdsGAInstances={instances:[],getInstance:function(a){return void 0===this.instances[a]&&(this.instances[a]=new AdvAdsGATracker(a,advads_gatracking_uids[a])),this.instances[a]}};function AdvAdsGATracker(a,e){this.blogId=a,this.propertyIds="string"==typeof e?[e]:e,this.normalTrackingDone=!1,this.clickTimer=null;const d=this;return this.getQueryString=function(a){var e=document.createElement("a");e.href=a;var d=e.search;if(d.length&&(d=(d=d.substr(1)).split("&")).length){var t={};for(var n in d){var s=d[n].split("=");t[s[0]]=s[1]}return t}return[]},this.appendQueryString=function(a,e){for(var d in e)-1!==a.indexOf("?")?a+="&"+d+"="+e[d]:a+="?"+d+"="+e[d];return a},this.trackImpressions=function(a){void 0===a&&(a=!1);var e=[];if(!this.normalTrackingDone&&AdvAdsTrackingUtils.hasAd(AdvAdsTrackingUtils.adsByBlog(advads_tracking_ads,d.blogId))&&(e=e.concat(advads_tracking_ads[d.blogId])),"frontend"===advads_tracking_methods[d.blogId]&&(e=[]),a?void 0!==advadsGATracking.delayedAds&&AdvAdsTrackingUtils.hasAd(AdvAdsTrackingUtils.adsByBlog(advadsGATracking.delayedAds,d.blogId))&&(e=e.concat(advadsGATracking.delayedAds[d.blogId]),advadsGATracking.delayedAds[d.blogId]=[]):void 0!==advadsGATracking.deferedAds&&AdvAdsTrackingUtils.hasAd(AdvAdsTrackingUtils.adsByBlog(advadsGATracking.deferedAds,d.blogId))&&(e=e.concat(advadsGATracking.deferedAds[d.blogId]),advadsGATracking.deferedAds[d.blogId]=[]),"undefined"!=typeof advads&&void 0!==advads.privacy.is_ad_decoded&&(e=e.filter(advads.privacy.is_ad_decoded)),e.length){for(var t in e)void 0!==advads_gatracking_allads[d.blogId][e[t]]&&advads_gatracking_allads[d.blogId][e[t]].impression&&d.sendEvent(advancedAds.tracking.googleEvents.impression,{event_category:"Advanced Ads",event_label:"["+e[t]+"] "+advads_gatracking_allads[d.blogId][e[t]].title,non_interaction:!0});this.normalTrackingDone=!0}},this.trackClick=function(a,e,t,n){void 0===e&&(e=!0);var s={event_category:"Advanced Ads",event_label:"["+a+"] "+advads_gatracking_allads[d.blogId][a].title,non_interaction:!0};if(t||n){var i=advads_gatracking_allads[d.blogId][a].target;void 0===advadsGATracking.postContext&&(i=(i=(i=i.replace("[CAT_SLUG]",advadsGATracking.postContext.cats)).replace("[POST_ID]",advadsGATracking.postContext.postID)).replace("[POST_SLUG]",advadsGATracking.postContext.postSlug)),i=i.replace("[AD_ID]",a);var r=n.getAttribute("href");e?i=r:(i=d.appendQueryString(i,d.getQueryString(r)),void 0!==advads_gatracking_transmitpageqs[d.blogId]&&advads_gatracking_transmitpageqs[d.blogId][a]&&(i=d.appendQueryString(i,d.getQueryString(document.location.href))));var c=!!n.getAttribute("target");if(c)d.sendEvent(advancedAds.tracking.googleEvents.click,s),e||n.setAttribute("href",i);else{function o(){null!==d.clickTimer&&(clearTimeout(d.clickTimer),d.clickTimer=null),window.location=i}t.preventDefault(),d.clickTimer=setTimeout((function(){o()}),1e3),s.event_callback=o,d.sendEvent(advancedAds.tracking.googleEvents.click,s)}}else d.sendEvent(advancedAds.tracking.googleEvents.click,s)},this.sendEvent=(a,e)=>{d.propertyIds.forEach((d=>{e.send_to=d,gtag("event",a,structuredClone(e))}))},function(){if("function"!=typeof gtag){var a=document.createElement("script");a.src="https://www.googletagmanager.com/gtag/js",a.async=!0,document.body.appendChild(a),window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date)}var e={send_page_view:!1,transport_type:"beacon"};window.advads_gatracking_anonym&&(e.anonymize_ip=!0),d.propertyIds.forEach((a=>{gtag("config",a,e)})),document.addEventListener("advadsGADeferedTrack",(function(){d.trackImpressions(!1)})),document.addEventListener("advadsGADelayedTrack",(function(){d.trackImpressions(!0)})),d.trackImpressions()}(),this}document.addEventListener("DOMContentLoaded",(function(){for(let a in advads_tracking_methods)if(a=parseInt(a,10),!isNaN(a)&&AdvAdsTrackingUtils.blogUseGA(a)){if("undefined"!=typeof advads&&"unknown"===advads.privacy.get_state())return void document.addEventListener("advanced_ads_privacy",(function(e){"not_needed"!==e.detail.state&&"accepted"!==e.detail.state||advancedAdsGAInstances.getInstance(a)}));advancedAdsGAInstances.getInstance(a)}}));
