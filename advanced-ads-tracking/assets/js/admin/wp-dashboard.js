(()=>{"use strict";var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=jQuery;var a=t.n(e);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function r(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,s(o.key),o)}}function s(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,e||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var i=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.classTrack=a()(".advads-performing-ads-track"),this.inpPeriod=a()("[name=advads-performing-ads-period]"),this.customFrom=a()("[name=advads-custom-from]"),this.customTo=a()("[name=advads-custom-to]"),this.adsContainer=a()("#advads-performing-container"),this.spinner=a()(".advads-spinner"),this.activeTab="",this.oldPrefs={},this.init()},e=[{key:"enableElements",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.classTrack.toggleClass("disabled",!t),this.inpPeriod.prop("disabled",!t),this.customFrom.prop("disabled",!t),this.customTo.prop("disabled",!t),this.spinner.toggleClass("disabled",t)}},{key:"tabs",value:function(){var t=this;this.classTrack.find("ul li").on("click",(function(e){var o=a()(e.currentTarget);o.addClass("active").siblings().removeClass("active"),t.activeTab=o.data("tab"),a()(".advads-performing-tab-".concat(t.activeTab)).addClass("active").siblings().removeClass("active"),t.saveUserPrefs()}))}},{key:"handlePeriodChange",value:function(){var t=this,e=a()(".advads-custom-period-wrapper");this.inpPeriod.on("change",(function(){var o={period:t.inpPeriod.val(),groupby:"day"},r="custom"===o.period;if(e.toggle(r),r){o.from=t.customFrom.val(),o.to=t.customTo.val();var s=new Date(o.from),i=new Date(o.to);if(isNaN(s.getTime())||isNaN(i.getTime())||s>i)return}var n={action:"advads_render_dashboard_ads_widget",args:a().param(o),nonce:advadsglobal.ajax_nonce};t.renderStats(n),t.classTrack.find("[data-tab=".concat(t.activeTab,"]")).trigger("click")}))}},{key:"renderStats",value:function(t){var e=this;a().ajax({url:ajaxurl,type:"POST",data:t,beforeSend:function(){e.enableElements(!1),e.adsContainer.html("")},complete:function(){e.enableElements()}}).done((function(t){e.adsContainer.html(t),a()(".advads-performing-tab-".concat(e.activeTab)).addClass("active")}))}},{key:"saveUserPrefs",value:function(){var t={metric:this.activeTab,customFrom:this.customFrom.val(),customTo:this.customTo.val(),period:this.inpPeriod.val()};if(t.metric!==this.oldPrefs.metric||t.customFrom!==this.oldPrefs.customFrom||t.customTo!==this.oldPrefs.customTo||t.period!==this.oldPrefs.period){this.oldPrefs.metric=t.metric,this.oldPrefs.customFrom=t.customFrom,this.oldPrefs.customTo=t.customTo,this.oldPrefs.period=t.period;var e={action:"advads_dashboard_ads_widget_user_prefs",nonce:advadsglobal.ajax_nonce,period:this.inpPeriod.val(),metric:this.activeTab,custom_from:this.customFrom.val(),custom_to:this.customTo.val()};a().ajax({url:ajaxurl,type:"POST",data:e})}}},{key:"getUserPrefs",value:function(){this.oldPrefs.metric=advancedAds.dashboardAdsWidget.metric,this.oldPrefs.customFrom=advancedAds.dashboardAdsWidget.customFrom,this.oldPrefs.customTo=advancedAds.dashboardAdsWidget.customTo,this.oldPrefs.period=advancedAds.dashboardAdsWidget.period,this.activeTab=this.oldPrefs.metric,this.classTrack.find("[data-tab=".concat(this.activeTab,"]")),this.customFrom.val(this.oldPrefs.customFrom),this.customTo.val(this.oldPrefs.customTo),this.inpPeriod.val(advancedAds.dashboardAdsWidget.period).trigger("change")}},{key:"handleCustomPeriod",value:function(){var t=this;this.customFrom.on("change",(function(){return t.dateChange()})),this.customTo.on("change",(function(){return t.dateChange()}))}},{key:"dateChange",value:function(){var t=new Date(this.customFrom.val()),e=new Date(this.customTo.val());!isNaN(t.getTime())&&!isNaN(e.getTime())&&t<e&&this.inpPeriod.trigger("change")}},{key:"init",value:function(){this.enableElements(),this.tabs(),this.handlePeriodChange(),this.handleCustomPeriod(),this.customFrom.datepicker({dateFormat:"mm/dd/yy"}),this.customTo.datepicker({dateFormat:"mm/dd/yy"}),this.getUserPrefs()}}],e&&r(t.prototype,e),o&&r(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,o}();a()((function(){new i}))})();